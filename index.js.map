{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst API_KEY = '53431502-05bc1324bd266ac6e07fa7d19';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport const limit = 15;\n\nexport async function getImagesByQuery(query, page) {\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: limit,\n    page,\n  };\n\n  const response = await axios.get('/', { params });\n  return response.data;\n}\n","// Описаний у документації\nimport SimpleLightbox from 'simplelightbox';\n// Додатковий імпорт стилів\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function createGallery(images) {\n  const markup = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `\n        <li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n            </a>\n            <div class=\"info\">\n            <p><b>Likes</b> ${likes}</p>\n            <p><b>Views</b> ${views}</p>\n            <p><b>Comments</b> ${comments}</p>\n            <p><b>Downloads</b> ${downloads}</p>\n            </div>\n        </li>`;\n      }\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n\nexport function showLoader() {\n  loader.classList.remove('is-hidden');\n}\n\nexport function hideLoader() {\n  loader.classList.add('is-hidden');\n}\n\nexport function showLoadMoreButton() {\n  loadMoreBtn.classList.remove('is-hidden');\n}\n\nexport function hideLoadMoreButton() {\n  loadMoreBtn.classList.add('is-hidden');\n}\n","import { getImagesByQuery, limit } from './js/pixabay-api.js';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n} from './js/render-functions.js';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.querySelector('.form');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nlet queryValue = '';\nlet page = 1;\nlet totalHits = 0;\n\nform.addEventListener('submit', onFormSubmit);\nloadMoreBtn.addEventListener('click', onLoadMore);\n\nasync function onFormSubmit(event) {\n  event.preventDefault();\n\n  const newValue = event.target.elements['search-text'].value.trim();\n\n  if (!newValue) {\n    iziToast.warning({\n      message: 'Please, enter your query',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  queryValue = newValue;\n  page = 1;\n  totalHits = 0;\n\n  clearGallery();\n  hideLoadMoreButton();\n\n  await fetchImages({ isNewSearch: true });\n  form.reset();\n}\n\nasync function onLoadMore() {\n  await fetchImages({ isNewSearch: false });\n  smoothScrollGallery();\n}\n\nasync function fetchImages({ isNewSearch }) {\n  showLoader();\n  hideLoadMoreButton();\n\n  try {\n    const data = await getImagesByQuery(queryValue, page);\n    const { hits, totalHits: apiTotalHits } = data;\n\n    if (isNewSearch) {\n      if (!hits.length) {\n        clearGallery();\n        iziToast.info({\n          message: 'Pictures not found. Try another query',\n          position: 'topRight',\n        });\n        return;\n      }\n\n      totalHits = apiTotalHits;\n    }\n\n    if (!hits.length) {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: 'We are sorry, but you have reached the end of search results',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    createGallery(hits);\n\n    const totalPages = Math.ceil(totalHits / limit);\n\n    if (page < totalPages) {\n      showLoadMoreButton();\n    } else {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: 'We are sorry, but you have reached the end of search results',\n        position: 'topRight',\n      });\n    }\n\n    page += 1;\n  } catch (error) {\n    iziToast.error({\n      message: 'An error occured during loading. Please try again later',\n      position: 'topRight',\n    });\n  } finally {\n    hideLoader();\n  }\n}\n\nfunction smoothScrollGallery() {\n  const firstPic = document.querySelector('.gallery-item');\n  if (!firstPic) return;\n  const { height: picHeight } = firstPic.getBoundingClientRect();\n\n  window.scrollBy({\n    top: picHeight * 2,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n"],"names":["API_KEY","axios","limit","getImagesByQuery","query","page","params","gallery","loader","loadMoreBtn","lightbox","SimpleLightbox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","queryValue","totalHits","onFormSubmit","onLoadMore","event","newValue","iziToast","fetchImages","smoothScrollGallery","isNewSearch","data","hits","apiTotalHits","totalPages","firstPic","picHeight"],"mappings":"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"}